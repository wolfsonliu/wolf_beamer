% for widescreen, 16:9, 33.867 x 19.05 cm, 13.33 x 7.5 in
% for standard, 4:3, 25.4 x 19.05 cm, 10 x 7.5 in

\RequirePackage{tikz}
\usetikzlibrary{fadings}
\RequirePackage{iftex}
\RequirePackage{xcolor}

\AtBeginDocument{\setbeamertemplate{logo}{}}

\definecolor{UCLABlue}{RGB}{39,116,174}
\definecolor{UCLADarkestBlue}{RGB}{0,59,92}
\definecolor{UCLADarkerBlue}{RGB}{0,85,135}
\definecolor{UCLALighterBlue}{RGB}{139,184,232}
\definecolor{UCLALightestBlue}{RGB}{218,235,254}
\definecolor{UCLAGold}{RGB}{255,209,0}
\definecolor{UCLADarkestGold}{RGB}{255,184,28}
\definecolor{UCLADarkerGold}{RGB}{255,199,44}


\newcommand{\UCLA@framepagelogo}{}
\newcommand{\UCLA@department}{}
\newcommand{\UCLA@titlepagelogo}{}
\newcommand{\UCLA@titlepagebackground}{}
\newcommand{\UCLA@date}{}

\renewcommand{\date}[1]{\renewcommand{\UCLA@date}{#1}}
\newcommand{\framepagelogo}[1]{\renewcommand{\UCLA@framepagelogo}{#1}}
\newcommand{\department}[1]{\renewcommand{\UCLA@department}{#1}}
\newcommand{\titlepagelogo}[1]{\renewcommand{\UCLA@titlepagelogo}{#1}}

\setbeamercolor{normal text}{fg=white}
\setbeamercolor{frametitle}{fg=UCLABlue}
\setbeamercolor{footline}{fg=white}
\setbeamercolor{section}{bg=UCLADarkerBlue, fg=white}
\setbeamercolor{subsection}{bg=UCLADarkerBlue, fg=white}
\setbeamercolor*{item}{fg=UCLADarkestGold}
\setbeamercolor*{item projected}{bg=UCLADarkestGold}
\setbeamercolor*{enumerate item}{fg=UCLADarkestGold}
\setbeamercolor*{enumerate subitem}{parent={enumerate item}}
\setbeamercolor*{enumerate subsubitem}{parent={enumerate item}}
\setbeamercolor{local structure}{fg=UCLAGold}
\setbeamercolor{title page}{fg=UCLABlue}
\setbeamercolor{block title}{fg=UCLAGold}
\setbeamercolor{block title example}{fg=UCLAGold}
\setbeamercolor{section in toc}{fg=UCLAGold}
\setbeamercolor{subsection in toc}{fg=UCLAGold}
\setbeamercolor{section in head/foot}{fg=UCLABlue}
\setbeamercolor{subsection in head/foot}{fg=UCLABlue}

\setbeamerfont{title}{size=\LARGE}
\setbeamerfont{author}{size=\small}
\setbeamerfont{department}{size=\scriptsize}
\setbeamerfont{date}{size=\scriptsize}
\setbeamerfont{frametitle}{series=\bfseries}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{itemize items}[square]
% \setbeamertemplate{background canvas}[vertical shading][bottom=white,top=white]

\setbeamertemplate{frametitle}{
\vspace*{0.1cm}%
\begin{beamercolorbox}{frametitle}
  \hspace*{0cm}
  \begin{minipage}{0.9\textwidth}
    \usebeamerfont{frametitle}\insertframetitle
  \end{minipage}
\end{beamercolorbox}
}

\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
    \ifnum\thepage>1\relax%
    \begin{beamercolorbox}[wd=0.3\paperwidth, ht=0cm, dp=1ex, left, leftskip=0.4cm, sep=0.00cm]{footline}%
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=0.4\paperwidth, ht=0cm, dp=1ex, center, sep=0.05cm]{footline}%
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=0.3\paperwidth, ht=0cm, dp=1ex, right, rightskip=0.1cm, sep=0.05cm]{footline}%
      \insertframenumber{} / \inserttotalframenumber%
    \end{beamercolorbox}
    \fi%
  }
}

\setbeamertemplate{background}{%
  \ifnum\thepage>1\relax%
  % normal page
  \begin{tikzpicture}
    \useasboundingbox (0cm, 0cm) rectangle (\the\paperwidth,\the\paperheight);
    \fill[black] (0cm, 0cm) rectangle (\the\paperwidth, \the\paperheight);
    % building
    \draw[UCLAGold] (0cm, 0.74cm) -- (0.46cm, 0.65cm) -- (0.56cm, 0.58cm) -- (0.56cm, 0.0cm);
    \draw[UCLAGold] (0.53cm, 1.18cm) -- (0.71cm, 1.30cm) -- (0.96cm, 1.20cm) -- (0.96cm, 0.0cm);
    \draw[UCLAGold] (0.53cm, 1.18cm) -- (0.53cm, 0.60cm);
    \draw[UCLAGold] (0.71cm, 1.30cm) -- (0.71cm, 0.0cm);
    \draw[UCLAGold] (0.96cm, 0.68cm) -- (1.16cm, 0.74cm) -- (1.36cm, 0.58cm);
    \draw[UCLAGold] (1.19cm, 0.72cm) -- (1.19cm, 0.95cm) -- (1.36cm, 1.00cm) -- (1.51cm, 0.95cm) -- (1.51cm, 0.0cm);
    \draw[UCLAGold] (1.36cm, 1.00cm) -- (1.36cm, 0.0cm);
    \draw[UCLAGold] (1.51cm, 0.44cm) -- (2.00cm, 0.35cm);
    %% logo
    \node[anchor=center, rotate=90]
    at (\the\paperwidth - 0.35cm, \the\paperheight - 0.75cm) {\includegraphics[height=0.7cm]{\UCLA@framepagelogo}};
  \end{tikzpicture}
  \else%
  % title page
  \begin{tikzpicture}
    \useasboundingbox (0cm, 0cm) rectangle (\the\paperwidth,\the\paperheight);
    \fill[black] (0cm, 0cm) rectangle (\the\paperwidth, \the\paperheight);
    % building
    \draw[UCLAGold] (0cm, 0.74cm) -- (0.46cm, 0.65cm) -- (0.56cm, 0.58cm) -- (0.56cm, 0.0cm);
    \draw[UCLAGold] (0.53cm, 1.18cm) -- (0.71cm, 1.30cm) -- (0.96cm, 1.20cm) -- (0.96cm, 0.0cm);
    \draw[UCLAGold] (0.53cm, 1.18cm) -- (0.53cm, 0.60cm);
    \draw[UCLAGold] (0.71cm, 1.30cm) -- (0.71cm, 0.0cm);
    \draw[UCLAGold] (0.96cm, 0.68cm) -- (1.16cm, 0.74cm) -- (1.36cm, 0.58cm);
    \draw[UCLAGold] (1.19cm, 0.72cm) -- (1.19cm, 0.95cm) -- (1.36cm, 1.00cm) -- (1.51cm, 0.95cm) -- (1.51cm, 0.0cm);
    \draw[UCLAGold] (1.36cm, 1.00cm) -- (1.36cm, 0.0cm);
    \draw[UCLAGold] (1.51cm, 0.44cm) -- (2.00cm, 0.35cm);
    % guide
    % \draw[gray] (0.66 * \the\paperwidth, 0.33 * \the\paperheight) -- (\the\paperwidth, 0.33 * \the\paperheight);
    %% logo
    \node[anchor=center] at (\the\paperwidth - 1.5cm, \the\paperheight - 0.7cm) {\includegraphics[width=3cm]{\UCLA@titlepagelogo}};
    %% guide
    % \draw[step=1, help lines] (0,0) grid (\the\paperwidth,\the\paperheight);
  \end{tikzpicture}
  \fi%
}

\setbeamertemplate{title page}{
  \usebeamercolor{title page}
  \begin{tikzpicture}
    \useasboundingbox (1, 0) rectangle (\the\paperwidth, \the\paperheight);
    %% title
    \node[anchor=center, font=\usebeamerfont{title}] at (\the\paperwidth * 0.5, \the\paperheight * 0.68) {
      \begin{minipage}{0.9\textwidth}
        \centering
        \inserttitle
      \end{minipage}
    };
    %% speaker and department
    \node[anchor=center, font=\usebeamerfont{author}] at (\the\paperwidth * 0.5, \the\paperheight * 0.38) {\insertauthor};
    \node[anchor=center, font=\usebeamerfont{department}] at (\the\paperwidth * 0.5, \the\paperheight * 0.33) {\UCLA@department};
    \node[anchor=center, font=\usebeamerfont{date}] at (\the\paperwidth * 0.5, \the\paperheight * 0.28) {\insertdate};
    %% guide
    % \draw[step=1, help lines] (0,0) grid (current page.north east);
  \end{tikzpicture}
}
