% for widescreen, 16:9, 33.867 x 19.05 cm, 13.33 x 7.5 in
% for standard, 4:3, 25.4 x 19.05 cm, 10 x 7.5 in

\RequirePackage{tikz}
\usetikzlibrary{fadings}
\RequirePackage{iftex}
\RequirePackage{xcolor}

\AtBeginDocument{\setbeamertemplate{logo}{}}

\definecolor{UCLABlue}{RGB}{39,116,174}
\definecolor{UCLADarkestBlue}{RGB}{0,59,92}
\definecolor{UCLADarkerBlue}{RGB}{0,85,135}
\definecolor{UCLALighterBlue}{RGB}{139,184,232}
\definecolor{UCLALightestBlue}{RGB}{218,235,254}
\definecolor{UCLAGold}{RGB}{255,209,0}
\definecolor{UCLADarkestGold}{RGB}{255,184,28}
\definecolor{UCLADarkerGold}{RGB}{255,199,44}


\newcommand{\UCLA@framepagelogo}{}
\newcommand{\UCLA@department}{}
\newcommand{\UCLA@titlepagelogo}{}
\newcommand{\UCLA@titlepageimage}{}
\newcommand{\UCLA@date}{}

\renewcommand{\date}[1]{\renewcommand{\UCLA@date}{#1}}
\newcommand{\framepagelogo}[1]{\renewcommand{\UCLA@framepagelogo}{#1}}
\newcommand{\department}[1]{\renewcommand{\UCLA@department}{#1}}
\newcommand{\titlepagelogo}[1]{\renewcommand{\UCLA@titlepagelogo}{#1}}
\newcommand{\titlepageimage}[1]{\renewcommand{\UCLA@titlepageimage}{#1}}

\setbeamercolor{normal text}{fg=UCLADarkestBlue}
\setbeamercolor{frametitle}{fg=UCLABlue}
\setbeamercolor{footline}{fg=white}
\setbeamercolor{section}{bg=UCLADarkerBlue, fg=white}
\setbeamercolor{subsection}{bg=UCLADarkerBlue, fg=white}
\setbeamercolor*{item}{fg=UCLADarkestGold}
\setbeamercolor*{item projected}{bg=UCLADarkestGold}
\setbeamercolor*{enumerate item}{fg=UCLADarkestGold}
\setbeamercolor*{enumerate subitem}{parent={enumerate item}}
\setbeamercolor*{enumerate subsubitem}{parent={enumerate item}}
\setbeamercolor{local structure}{fg=UCLADarkestGold}
\setbeamercolor{title page}{fg=white}
\setbeamercolor{block title}{fg=UCLADarkestGold}
\setbeamercolor{block title example}{fg=UCLADarkestGold}
\setbeamercolor{section in toc}{fg=UCLADarkerBlue}
\setbeamercolor{subsection in toc}{fg=UCLADarkerBlue}
\setbeamercolor{section in head/foot}{fg=UCLADarkerBlue}
\setbeamercolor{subsection in head/foot}{fg=white}

\setbeamerfont{title}{size=\LARGE}
\setbeamerfont{author}{size=\small}
\setbeamerfont{department}{size=\scriptsize}
\setbeamerfont{date}{size=\scriptsize}
\setbeamerfont{frametitle}{series=\bfseries}
\setbeamerfont{footline}{family=\sffamily}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{itemize items}[square]
% \setbeamertemplate{background canvas}[vertical shading][bottom=white,top=white]

\setbeamertemplate{frametitle}{
\vspace*{0.1cm}%
\begin{beamercolorbox}{frametitle}
    \usebeamerfont{frametitle}\insertframetitle
\end{beamercolorbox}
}

\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
    \ifnum\thepage>1\relax%
    \begin{beamercolorbox}[wd=\paperwidth, ht=0cm, dp=1ex, right, rightskip=0.15cm, sep=0.05cm]{footline}%
      \insertframenumber%
      \newline%
      --
      \newline%
      \inserttotalframenumber
    \end{beamercolorbox}%
    \fi%
  }
}

\setbeamertemplate{background}{%
  \ifnum\thepage>1\relax%
  % frame page
  \begin{tikzpicture}
    \useasboundingbox (0cm, 0cm) rectangle (\the\paperwidth, \the\paperheight);
    \fill[UCLABlue]
    (\the\paperwidth - 0.6cm, \the\paperheight - 2.15cm)
    -- (\the\paperwidth, \the\paperheight - 2.15cm)
    -- (\the\paperwidth, 0cm)
    -- (\the\paperwidth - 0.6cm, 0cm)
    -- cycle;
    \draw[UCLAGold, line width=0.1cm]
    (\the\paperwidth - 0.6cm, \the\paperheight - 2.15cm)
    -- (\the\paperwidth, \the\paperheight - 2.15cm);
    %% logo
    \node[anchor=center, rotate=90] at (\the\paperwidth - 0.3cm, \the\paperheight - 1cm) {\includegraphics[height=0.6cm]{\UCLA@framepagelogo}};
  \end{tikzpicture}
  \else%
  % title page
  \begin{tikzpicture}
    \useasboundingbox (0cm, 0cm) rectangle (\the\paperwidth,\the\paperheight);
    \node[anchor=west] at (-0.2cm, 0.5 * \the\paperheight) {%
      \includegraphics[height=3.54in]{\UCLA@titlepageimage}
    };
    \fill[UCLABlue]
    (0.62 * \the\paperwidth, 0cm) rectangle (\the\paperwidth, \the\paperheight);
    %% logo
    \node[anchor=north] at (0.81 * \the\paperwidth, \the\paperheight - 0.5cm) {\includegraphics[width=3.2cm]{\UCLA@titlepagelogo}};
    %% separation line
    \draw[UCLAGold, line width = 0.05cm]
    (0.71 * \the\paperwidth, 0.33 * \the\paperheight)
    -- (0.91 * \the\paperwidth, 0.33 * \the\paperheight);
    %% guide
    % \draw[step=1, help lines] (0,0) grid (\the\paperwidth,\the\paperheight);
  \end{tikzpicture}
  \fi%
}

\setbeamertemplate{title page}{
  \usebeamercolor{title page}
  \begin{tikzpicture}
    \useasboundingbox (1, 0) rectangle (\the\paperwidth, \the\paperheight);
    %% title
    \node[anchor=north, font=\usebeamerfont{title}] at (0.81 * \the\paperwidth, 0.75 * \the\paperheight) {%
      \begin{minipage}{0.35\textwidth}
        \centering
        \inserttitle
      \end{minipage}
    };
    %% speaker and department
    \node[anchor=south, font=\usebeamerfont{author}] at (0.81 * \the\paperwidth, \the\paperheight * 0.25) {\insertauthor};
    \node[anchor=south, font=\usebeamerfont{department}] at (0.81 * \the\paperwidth, \the\paperheight * 0.15) {
      \begin{minipage}{0.35\textwidth}
        \centering
        \UCLA@department
      \end{minipage}
    };
    \node[anchor=south, font=\usebeamerfont{date}] at (0.81 * \the\paperwidth, \the\paperheight * 0.10) {\insertdate};
    %% guide
    % \draw[step=1, help lines] (0,0) grid (current page.north east);
  \end{tikzpicture}
}
